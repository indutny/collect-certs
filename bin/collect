#!/usr/bin/env node
var collector = require('../');
var cluster = require('cluster');
var os = require('os');
var ProgressBar = require('progress');

var bar = new ProgressBar(':bar :current/:total :eta', {
  total: 10000,
  width: 80,
  clear: true
});

var options = {
  parallel: 1000,
  workers: 4,
  db: './certs'
};

if (cluster.isMaster) {
  var master = new collector.Master(options);

  master.on('log', function(msg) {
    console.error(msg);
  });

  master.on('cert', function(cert) {
    bar.tick();
  });
} else {
  var worker = new collector.Worker(options);
}
