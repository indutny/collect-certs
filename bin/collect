#!/usr/bin/env node
var collector = require('../');
var cluster = require('cluster');
var os = require('os');

var options = {
  parallel: 1000,
  workers: os.cpus().length,
  db: './certs'
};

if (cluster.isMaster) {
  var master = new collector.Master(options);

  master.on('log', function(msg) {
    console.error(msg);
  });

  master.on('cert', function(cert) {
    process.stdout.write('.');
  });
} else {
  var worker = new collector.Worker(options);
}
